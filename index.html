<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>FoolsTool - Ultimate Debugger</title>
    <style>
        body { background-color: #121212; color: #fff; font-family: sans-serif; padding: 20px; }
        .control-panel { background: #333; padding: 15px; border-radius: 8px; margin-bottom: 20px; }
        select, button { padding: 10px; margin: 5px 0; font-size: 16px; border-radius: 4px; border: none; }
        button { background-color: #4CAF50; color: white; cursor: pointer; }
        button:hover { background-color: #45a049; }
        .grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(250px, 1fr)); gap: 15px; }
        .card { background: #222; border-radius: 8px; overflow: hidden; border: 1px solid #444; }
        .card img { width: 100%; aspect-ratio: 16/9; object-fit: cover; }
        .card-content { padding: 10px; }
        .card h4 { margin: 0; font-size: 14px; line-height: 1.4; }
        #status { font-weight: bold; margin-bottom: 10px; color: #aaa; }
    </style>
</head>
<body>

    <h1>FoolsTool: Ultimate Debugger</h1>
    
    <div class="control-panel">
        <label>1. ã‚µãƒ¼ãƒãƒ¼ã‚’é¸ã¶:</label><br>
        <select id="server-select">
            <option value="https://yewtu.be">yewtu.be (ãƒ‰å®šç•ªãƒ»å®‰å®š)</option>
            <option value="https://inv.tux.pizza">inv.tux.pizza (é«˜é€Ÿ)</option>
            <option value="https://vid.puffyan.us">vid.puffyan.us (äºˆå‚™)</option>
            <option value="https://invidious.drgns.space">drgns.space (äºˆå‚™2)</option>
        </select>
        <br><br>
        
        <label>2. é­”æ³•(ãƒ—ãƒ­ã‚­ã‚·)ã‚’é¸ã¶:</label><br>
        <select id="proxy-select">
            <option value="https://corsproxy.io/?">CorsProxy (æœ€å¼·ãƒ»æ¨å¥¨)</option>
            <option value="https://api.allorigins.win/raw?url=">AllOrigins (äºˆå‚™)</option>
            <option value="">ãªã— (ç›´çµãƒ»é‹è©¦ã—)</option>
        </select>
        <br><br>

        <button onclick="startLoad()">æ¥ç¶šãƒ†ã‚¹ãƒˆé–‹å§‹</button>
    </div>

    <div id="status">è¨­å®šã‚’é¸ã‚“ã§ã€Œæ¥ç¶šãƒ†ã‚¹ãƒˆé–‹å§‹ã€ã‚’æŠ¼ã—ã¦ãã ã•ã„</div>
    <div id="video-list" class="grid"></div>

    <script>
        async function startLoad() {
            const server = document.getElementById("server-select").value;
            const proxy = document.getElementById("proxy-select").value;
            const status = document.getElementById("status");
            const list = document.getElementById("video-list");

            // ç”»é¢ãƒªã‚»ãƒƒãƒˆ
            list.innerHTML = "";
            status.innerHTML = "ğŸ”„ é€šä¿¡ä¸­...";
            status.style.color = "yellow";

            try {
                // URLã‚’çµ„ã¿ç«‹ã¦ã‚‹
                // ãƒ—ãƒ­ã‚­ã‚·ãŒã‚ã‚‹å ´åˆã¯ã‚¨ãƒ³ã‚³ãƒ¼ãƒ‰(URLæ–‡å­—å¤‰æ›)ãŒå¿…è¦
                let finalUrl = "";
                if (proxy) {
                    finalUrl = proxy + encodeURIComponent(server + "/api/v1/popular");
                } else {
                    finalUrl = server + "/api/v1/popular";
                }

                console.log("Target URL:", finalUrl);

                const response = await fetch(finalUrl);
                
                if (!response.ok) {
                    throw new Error(`ã‚µãƒ¼ãƒãƒ¼æ‹’å¦ (${response.status})`);
                }

                const data = await response.json();

                // æˆåŠŸï¼
                status.innerHTML = `âœ… æˆåŠŸï¼ (Server: ${new URL(server).hostname})`;
                status.style.color = "#4CAF50";

                data.slice(0, 10).forEach(video => {
                    // ç”»åƒã®URLã‚‚ãƒ—ãƒ­ã‚­ã‚·ã‚’é€šã•ãªã„ã¨è¡¨ç¤ºã•ã‚Œãªã„ã“ã¨ãŒã‚ã‚‹ã®ã§èª¿æ•´
                    let imgUrl = video.videoThumbnails[0].url;
                    // ç”»åƒURLãŒ / ã§å§‹ã¾ã‚‹ç›¸å¯¾ãƒ‘ã‚¹ã®å ´åˆã®å¯¾ç­–
                    if (!imgUrl.startsWith("http")) {
                        imgUrl = server + imgUrl;
                    }

                    list.innerHTML += `
                        <div class="card">
                            <img src="${imgUrl}" loading="lazy">
                            <div class="card-content">
                                <h4>${video.title}</h4>
                            </div>
                        </div>
                    `;
                });

            } catch (error) {
                console.error(error);
                status.innerHTML = `âŒ å¤±æ•—: ${error.message}<br>åˆ¥ã®çµ„ã¿åˆã‚ã›ã‚’è©¦ã—ã¦ãã ã•ã„`;
                status.style.color = "#ff5555";
            }
        }
    </script>
</body>
</html>
